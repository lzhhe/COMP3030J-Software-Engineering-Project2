!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("d3-selection"),require("d3")):"function"==typeof define&&define.amd?define(["d3-selection","d3"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).Legend=e(t.d3,t.d3)}(this,(function(t,e){"use strict";function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(o=r.key,i=void 0,"symbol"==typeof(i=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"))?i:String(i)),r)}var o,i}var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o=function(t){try{return!!t()}catch(t){return!0}},i=!o((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),a=!o((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),u=a,c=Function.prototype,s=c.call,l=u&&c.bind.bind(s,s),f=u?l:function(t){return function(){return s.apply(t,arguments)}},p=function(t){return null==t},d=p,h=TypeError,m=function(t){if(d(t))throw new h("Can't call method on "+t);return t},g=m,y=Object,v=function(t){return y(g(t))},b=v,w=f({}.hasOwnProperty),S=Object.hasOwn||function(t,e){return w(b(t),e)},O=i,j=S,M=Function.prototype,P=O&&Object.getOwnPropertyDescriptor,T=j(M,"name"),$={EXISTS:T,PROPER:T&&"something"===function(){}.name,CONFIGURABLE:T&&(!O||O&&P(M,"name").configurable)},k={exports:{}},E="object"==typeof document&&document.all,x={all:E,IS_HTMLDDA:void 0===E&&void 0!==E},R=x.all,C=x.IS_HTMLDDA?function(t){return"function"==typeof t||t===R}:function(t){return"function"==typeof t},N=function(t){return t&&t.Math===Math&&t},B=N("object"==typeof globalThis&&globalThis)||N("object"==typeof window&&window)||N("object"==typeof self&&self)||N("object"==typeof r&&r)||N("object"==typeof r&&r)||function(){return this}()||Function("return this")(),q=B,D=Object.defineProperty,A=function(t,e){try{D(q,t,{value:e,configurable:!0,writable:!0})}catch(n){q[t]=e}return e},I=A,G="__core-js_shared__",L=B[G]||I(G,{}),z=C,F=L,Y=f(Function.toString);z(F.inspectSource)||(F.inspectSource=function(t){return Y(t)});var _,U,W=F.inspectSource,H=C,V=B.WeakMap,J=H(V)&&/native code/.test(String(V)),K=C,X=x.all,Z=x.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:K(t)||t===X}:function(t){return"object"==typeof t?null!==t:K(t)},Q={},tt=Z,et=B.document,nt=tt(et)&&tt(et.createElement),rt=function(t){return nt?et.createElement(t):{}},ot=rt,it=!i&&!o((function(){return 7!==Object.defineProperty(ot("div"),"a",{get:function(){return 7}}).a})),at=i&&o((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),ut=Z,ct=String,st=TypeError,lt=function(t){if(ut(t))return t;throw new st(ct(t)+" is not an object")},ft=a,pt=Function.prototype.call,dt=ft?pt.bind(pt):function(){return pt.apply(pt,arguments)},ht=B,mt=C,gt=function(t,e){return arguments.length<2?(n=ht[t],mt(n)?n:void 0):ht[t]&&ht[t][e];var n},yt=f({}.isPrototypeOf),vt="undefined"!=typeof navigator&&String(navigator.userAgent)||"",bt=B,wt=vt,St=bt.process,Ot=bt.Deno,jt=St&&St.versions||Ot&&Ot.version,Mt=jt&&jt.v8;Mt&&(U=(_=Mt.split("."))[0]>0&&_[0]<4?1:+(_[0]+_[1])),!U&&wt&&(!(_=wt.match(/Edge\/(\d+)/))||_[1]>=74)&&(_=wt.match(/Chrome\/(\d+)/))&&(U=+_[1]);var Pt=U,Tt=Pt,$t=o,kt=B.String,Et=!!Object.getOwnPropertySymbols&&!$t((function(){var t=Symbol("symbol detection");return!kt(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Tt&&Tt<41})),xt=Et&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Rt=gt,Ct=C,Nt=yt,Bt=Object,qt=xt?function(t){return"symbol"==typeof t}:function(t){var e=Rt("Symbol");return Ct(e)&&Nt(e.prototype,Bt(t))},Dt=String,At=function(t){try{return Dt(t)}catch(t){return"Object"}},It=C,Gt=At,Lt=TypeError,zt=function(t){if(It(t))return t;throw new Lt(Gt(t)+" is not a function")},Ft=zt,Yt=p,_t=function(t,e){var n=t[e];return Yt(n)?void 0:Ft(n)},Ut=dt,Wt=C,Ht=Z,Vt=TypeError,Jt={exports:{}},Kt=L;(Jt.exports=function(t,e){return Kt[t]||(Kt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.34.0",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.34.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Xt=Jt.exports,Zt=f,Qt=0,te=Math.random(),ee=Zt(1..toString),ne=function(t){return"Symbol("+(void 0===t?"":t)+")_"+ee(++Qt+te,36)},re=Xt,oe=S,ie=ne,ae=Et,ue=xt,ce=B.Symbol,se=re("wks"),le=ue?ce.for||ce:ce&&ce.withoutSetter||ie,fe=function(t){return oe(se,t)||(se[t]=ae&&oe(ce,t)?ce[t]:le("Symbol."+t)),se[t]},pe=dt,de=Z,he=qt,me=_t,ge=function(t,e){var n,r;if("string"===e&&Wt(n=t.toString)&&!Ht(r=Ut(n,t)))return r;if(Wt(n=t.valueOf)&&!Ht(r=Ut(n,t)))return r;if("string"!==e&&Wt(n=t.toString)&&!Ht(r=Ut(n,t)))return r;throw new Vt("Can't convert object to primitive value")},ye=TypeError,ve=fe("toPrimitive"),be=function(t,e){if(!de(t)||he(t))return t;var n,r=me(t,ve);if(r){if(void 0===e&&(e="default"),n=pe(r,t,e),!de(n)||he(n))return n;throw new ye("Can't convert object to primitive value")}return void 0===e&&(e="number"),ge(t,e)},we=qt,Se=function(t){var e=be(t,"string");return we(e)?e:e+""},Oe=i,je=it,Me=at,Pe=lt,Te=Se,$e=TypeError,ke=Object.defineProperty,Ee=Object.getOwnPropertyDescriptor,xe="enumerable",Re="configurable",Ce="writable";Q.f=Oe?Me?function(t,e,n){if(Pe(t),e=Te(e),Pe(n),"function"==typeof t&&"prototype"===e&&"value"in n&&Ce in n&&!n[Ce]){var r=Ee(t,e);r&&r[Ce]&&(t[e]=n.value,n={configurable:Re in n?n[Re]:r[Re],enumerable:xe in n?n[xe]:r[xe],writable:!1})}return ke(t,e,n)}:ke:function(t,e,n){if(Pe(t),e=Te(e),Pe(n),je)try{return ke(t,e,n)}catch(t){}if("get"in n||"set"in n)throw new $e("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var Ne,Be,qe,De=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},Ae=Q,Ie=De,Ge=i?function(t,e,n){return Ae.f(t,e,Ie(1,n))}:function(t,e,n){return t[e]=n,t},Le=ne,ze=Xt("keys"),Fe={},Ye=J,_e=B,Ue=Z,We=Ge,He=S,Ve=L,Je=function(t){return ze[t]||(ze[t]=Le(t))},Ke=Fe,Xe="Object already initialized",Ze=_e.TypeError,Qe=_e.WeakMap;if(Ye||Ve.state){var tn=Ve.state||(Ve.state=new Qe);tn.get=tn.get,tn.has=tn.has,tn.set=tn.set,Ne=function(t,e){if(tn.has(t))throw new Ze(Xe);return e.facade=t,tn.set(t,e),e},Be=function(t){return tn.get(t)||{}},qe=function(t){return tn.has(t)}}else{var en=Je("state");Ke[en]=!0,Ne=function(t,e){if(He(t,en))throw new Ze(Xe);return e.facade=t,We(t,en,e),e},Be=function(t){return He(t,en)?t[en]:{}},qe=function(t){return He(t,en)}}var nn={set:Ne,get:Be,has:qe,enforce:function(t){return qe(t)?Be(t):Ne(t,{})},getterFor:function(t){return function(e){var n;if(!Ue(e)||(n=Be(e)).type!==t)throw new Ze("Incompatible receiver, "+t+" required");return n}}},rn=f,on=o,an=C,un=S,cn=i,sn=$.CONFIGURABLE,ln=W,fn=nn.enforce,pn=nn.get,dn=String,hn=Object.defineProperty,mn=rn("".slice),gn=rn("".replace),yn=rn([].join),vn=cn&&!on((function(){return 8!==hn((function(){}),"length",{value:8}).length})),bn=String(String).split("String"),wn=k.exports=function(t,e,n){"Symbol("===mn(dn(e),0,7)&&(e="["+gn(dn(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!un(t,"name")||sn&&t.name!==e)&&(cn?hn(t,"name",{value:e,configurable:!0}):t.name=e),vn&&n&&un(n,"arity")&&t.length!==n.arity&&hn(t,"length",{value:n.arity});try{n&&un(n,"constructor")&&n.constructor?cn&&hn(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=fn(t);return un(r,"source")||(r.source=yn(bn,"string"==typeof e?e:"")),t};Function.prototype.toString=wn((function(){return an(this)&&pn(this).source||ln(this)}),"toString");var Sn=k.exports,On=Sn,jn=Q,Mn=function(t,e,n){return n.get&&On(n.get,e,{getter:!0}),n.set&&On(n.set,e,{setter:!0}),jn.f(t,e,n)},Pn=i,Tn=$.EXISTS,$n=f,kn=Mn,En=Function.prototype,xn=$n(En.toString),Rn=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,Cn=$n(Rn.exec);Pn&&!Tn&&kn(En,"name",{configurable:!0,get:function(){try{return Cn(Rn,xn(this))[1]}catch(t){return""}}});var Nn={},Bn={},qn={}.propertyIsEnumerable,Dn=Object.getOwnPropertyDescriptor,An=Dn&&!qn.call({1:2},1);Bn.f=An?function(t){var e=Dn(this,t);return!!e&&e.enumerable}:qn;var In=f,Gn=In({}.toString),Ln=In("".slice),zn=function(t){return Ln(Gn(t),8,-1)},Fn=o,Yn=zn,_n=Object,Un=f("".split),Wn=Fn((function(){return!_n("z").propertyIsEnumerable(0)}))?function(t){return"String"===Yn(t)?Un(t,""):_n(t)}:_n,Hn=Wn,Vn=m,Jn=function(t){return Hn(Vn(t))},Kn=i,Xn=dt,Zn=Bn,Qn=De,tr=Jn,er=Se,nr=S,rr=it,or=Object.getOwnPropertyDescriptor;Nn.f=Kn?or:function(t,e){if(t=tr(t),e=er(e),rr)try{return or(t,e)}catch(t){}if(nr(t,e))return Qn(!Xn(Zn.f,t,e),t[e])};var ir=C,ar=Q,ur=Sn,cr=A,sr=function(t,e,n,r){r||(r={});var o=r.enumerable,i=void 0!==r.name?r.name:e;if(ir(n)&&ur(n,i,r),r.global)o?t[e]=n:cr(e,n);else{try{r.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=n:ar.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},lr={},fr=Math.ceil,pr=Math.floor,dr=Math.trunc||function(t){var e=+t;return(e>0?pr:fr)(e)},hr=function(t){var e=+t;return e!=e||0===e?0:dr(e)},mr=hr,gr=Math.max,yr=Math.min,vr=hr,br=Math.min,wr=function(t){return t>0?br(vr(t),9007199254740991):0},Sr=function(t){return wr(t.length)},Or=Jn,jr=function(t,e){var n=mr(t);return n<0?gr(n+e,0):yr(n,e)},Mr=Sr,Pr=function(t){return function(e,n,r){var o,i=Or(e),a=Mr(i),u=jr(r,a);if(t&&n!=n){for(;a>u;)if((o=i[u++])!=o)return!0}else for(;a>u;u++)if((t||u in i)&&i[u]===n)return t||u||0;return!t&&-1}},Tr={includes:Pr(!0),indexOf:Pr(!1)},$r=S,kr=Jn,Er=Tr.indexOf,xr=Fe,Rr=f([].push),Cr=function(t,e){var n,r=kr(t),o=0,i=[];for(n in r)!$r(xr,n)&&$r(r,n)&&Rr(i,n);for(;e.length>o;)$r(r,n=e[o++])&&(~Er(i,n)||Rr(i,n));return i},Nr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Br=Cr,qr=Nr.concat("length","prototype");lr.f=Object.getOwnPropertyNames||function(t){return Br(t,qr)};var Dr={};Dr.f=Object.getOwnPropertySymbols;var Ar=gt,Ir=lr,Gr=Dr,Lr=lt,zr=f([].concat),Fr=Ar("Reflect","ownKeys")||function(t){var e=Ir.f(Lr(t)),n=Gr.f;return n?zr(e,n(t)):e},Yr=S,_r=Fr,Ur=Nn,Wr=Q,Hr=o,Vr=C,Jr=/#|\.prototype\./,Kr=function(t,e){var n=Zr[Xr(t)];return n===to||n!==Qr&&(Vr(e)?Hr(e):!!e)},Xr=Kr.normalize=function(t){return String(t).replace(Jr,".").toLowerCase()},Zr=Kr.data={},Qr=Kr.NATIVE="N",to=Kr.POLYFILL="P",eo=Kr,no=B,ro=Nn.f,oo=Ge,io=sr,ao=A,uo=function(t,e,n){for(var r=_r(e),o=Wr.f,i=Ur.f,a=0;a<r.length;a++){var u=r[a];Yr(t,u)||n&&Yr(n,u)||o(t,u,i(e,u))}},co=eo,so=function(t,e){var n,r,o,i,a,u=t.target,c=t.global,s=t.stat;if(n=c?no:s?no[u]||ao(u,{}):(no[u]||{}).prototype)for(r in e){if(i=e[r],o=t.dontCallGetSet?(a=ro(n,r))&&a.value:n[r],!co(c?r:u+(s?".":"#")+r,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;uo(i,o)}(t.sham||o&&o.sham)&&oo(i,"sham",!0),io(n,r,i,t)}},lo=Cr,fo=Nr,po=Object.keys||function(t){return lo(t,fo)},ho=i,mo=f,go=dt,yo=o,vo=po,bo=Dr,wo=Bn,So=v,Oo=Wn,jo=Object.assign,Mo=Object.defineProperty,Po=mo([].concat),To=!jo||yo((function(){if(ho&&1!==jo({b:1},jo(Mo({},"a",{enumerable:!0,get:function(){Mo(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol("assign detection"),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach((function(t){e[t]=t})),7!==jo({},t)[n]||vo(jo({},e)).join("")!==r}))?function(t,e){for(var n=So(t),r=arguments.length,o=1,i=bo.f,a=wo.f;r>o;)for(var u,c=Oo(arguments[o++]),s=i?Po(vo(c),i(c)):vo(c),l=s.length,f=0;l>f;)u=s[f++],ho&&!go(a,c,u)||(n[u]=c[u]);return n}:jo,$o=To;so({target:"Object",stat:!0,arity:2,forced:Object.assign!==$o},{assign:$o});var ko={};ko[fe("toStringTag")]="z";var Eo="[object z]"===String(ko),xo=Eo,Ro=C,Co=zn,No=fe("toStringTag"),Bo=Object,qo="Arguments"===Co(function(){return arguments}()),Do=xo?Co:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Bo(t),No))?n:qo?Co(e):"Object"===(r=Co(e))&&Ro(e.callee)?"Arguments":r},Ao=Do,Io=Eo?{}.toString:function(){return"[object "+Ao(this)+"]"};Eo||sr(Object.prototype,"toString",Io,{unsafe:!0});var Go="process"===zn(B.process),Lo=f,zo=zt,Fo=C,Yo=String,_o=TypeError,Uo=function(t,e,n){try{return Lo(zo(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(t){}},Wo=lt,Ho=function(t){if("object"==typeof t||Fo(t))return t;throw new _o("Can't set "+Yo(t)+" as a prototype")},Vo=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Uo(Object.prototype,"__proto__","set"))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return Wo(n),Ho(r),e?t(n,r):n.__proto__=r,n}}():void 0),Jo=Q.f,Ko=S,Xo=fe("toStringTag"),Zo=gt,Qo=Mn,ti=i,ei=fe("species"),ni=yt,ri=TypeError,oi=f,ii=o,ai=C,ui=Do,ci=W,si=function(){},li=[],fi=gt("Reflect","construct"),pi=/^\s*(?:class|function)\b/,di=oi(pi.exec),hi=!pi.test(si),mi=function(t){if(!ai(t))return!1;try{return fi(si,li,t),!0}catch(t){return!1}},gi=function(t){if(!ai(t))return!1;switch(ui(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return hi||!!di(pi,ci(t))}catch(t){return!0}};gi.sham=!0;var yi,vi,bi,wi,Si=!fi||ii((function(){var t;return mi(mi.call)||!mi(Object)||!mi((function(){t=!0}))||t}))?gi:mi,Oi=Si,ji=At,Mi=TypeError,Pi=lt,Ti=function(t){if(Oi(t))return t;throw new Mi(ji(t)+" is not a constructor")},$i=p,ki=fe("species"),Ei=a,xi=Function.prototype,Ri=xi.apply,Ci=xi.call,Ni="object"==typeof Reflect&&Reflect.apply||(Ei?Ci.bind(Ri):function(){return Ci.apply(Ri,arguments)}),Bi=zn,qi=f,Di=function(t){if("Function"===Bi(t))return qi(t)},Ai=zt,Ii=a,Gi=Di(Di.bind),Li=function(t,e){return Ai(t),void 0===e?t:Ii?Gi(t,e):function(){return t.apply(e,arguments)}},zi=gt("document","documentElement"),Fi=f([].slice),Yi=TypeError,_i=/(?:ipad|iphone|ipod).*applewebkit/i.test(vt),Ui=B,Wi=Ni,Hi=Li,Vi=C,Ji=S,Ki=o,Xi=zi,Zi=Fi,Qi=rt,ta=function(t,e){if(t<e)throw new Yi("Not enough arguments");return t},ea=_i,na=Go,ra=Ui.setImmediate,oa=Ui.clearImmediate,ia=Ui.process,aa=Ui.Dispatch,ua=Ui.Function,ca=Ui.MessageChannel,sa=Ui.String,la=0,fa={},pa="onreadystatechange";Ki((function(){yi=Ui.location}));var da=function(t){if(Ji(fa,t)){var e=fa[t];delete fa[t],e()}},ha=function(t){return function(){da(t)}},ma=function(t){da(t.data)},ga=function(t){Ui.postMessage(sa(t),yi.protocol+"//"+yi.host)};ra&&oa||(ra=function(t){ta(arguments.length,1);var e=Vi(t)?t:ua(t),n=Zi(arguments,1);return fa[++la]=function(){Wi(e,void 0,n)},vi(la),la},oa=function(t){delete fa[t]},na?vi=function(t){ia.nextTick(ha(t))}:aa&&aa.now?vi=function(t){aa.now(ha(t))}:ca&&!ea?(wi=(bi=new ca).port2,bi.port1.onmessage=ma,vi=Hi(wi.postMessage,wi)):Ui.addEventListener&&Vi(Ui.postMessage)&&!Ui.importScripts&&yi&&"file:"!==yi.protocol&&!Ki(ga)?(vi=ga,Ui.addEventListener("message",ma,!1)):vi=pa in Qi("script")?function(t){Xi.appendChild(Qi("script"))[pa]=function(){Xi.removeChild(this),da(t)}}:function(t){setTimeout(ha(t),0)});var ya={set:ra,clear:oa},va=function(){this.head=null,this.tail=null};va.prototype={add:function(t){var e={item:t,next:null},n=this.tail;n?n.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}};var ba,wa,Sa,Oa,ja,Ma=va,Pa=/ipad|iphone|ipod/i.test(vt)&&"undefined"!=typeof Pebble,Ta=/web0s(?!.*chrome)/i.test(vt),$a=B,ka=Li,Ea=Nn.f,xa=ya.set,Ra=Ma,Ca=_i,Na=Pa,Ba=Ta,qa=Go,Da=$a.MutationObserver||$a.WebKitMutationObserver,Aa=$a.document,Ia=$a.process,Ga=$a.Promise,La=Ea($a,"queueMicrotask"),za=La&&La.value;if(!za){var Fa=new Ra,Ya=function(){var t,e;for(qa&&(t=Ia.domain)&&t.exit();e=Fa.get();)try{e()}catch(t){throw Fa.head&&ba(),t}t&&t.enter()};Ca||qa||Ba||!Da||!Aa?!Na&&Ga&&Ga.resolve?((Oa=Ga.resolve(void 0)).constructor=Ga,ja=ka(Oa.then,Oa),ba=function(){ja(Ya)}):qa?ba=function(){Ia.nextTick(Ya)}:(xa=ka(xa,$a),ba=function(){xa(Ya)}):(wa=!0,Sa=Aa.createTextNode(""),new Da(Ya).observe(Sa,{characterData:!0}),ba=function(){Sa.data=wa=!wa}),za=function(t){Fa.head||ba(),Fa.add(t)}}var _a=za,Ua=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},Wa=B.Promise,Ha="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Va=!Ha&&!Go&&"object"==typeof window&&"object"==typeof document,Ja=B,Ka=Wa,Xa=C,Za=eo,Qa=W,tu=fe,eu=Va,nu=Ha,ru=Pt;Ka&&Ka.prototype;var ou=tu("species"),iu=!1,au=Xa(Ja.PromiseRejectionEvent),uu=Za("Promise",(function(){var t=Qa(Ka),e=t!==String(Ka);if(!e&&66===ru)return!0;if(!ru||ru<51||!/native code/.test(t)){var n=new Ka((function(t){t(1)})),r=function(t){t((function(){}),(function(){}))};if((n.constructor={})[ou]=r,!(iu=n.then((function(){}))instanceof r))return!0}return!e&&(eu||nu)&&!au})),cu={CONSTRUCTOR:uu,REJECTION_EVENT:au,SUBCLASSING:iu},su={},lu=zt,fu=TypeError,pu=function(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw new fu("Bad Promise constructor");e=t,n=r})),this.resolve=lu(e),this.reject=lu(n)};su.f=function(t){return new pu(t)};var du,hu,mu,gu=so,yu=Go,vu=B,bu=dt,wu=sr,Su=Vo,Ou=function(t,e,n){t&&!n&&(t=t.prototype),t&&!Ko(t,Xo)&&Jo(t,Xo,{configurable:!0,value:e})},ju=function(t){var e=Zo(t);ti&&e&&!e[ei]&&Qo(e,ei,{configurable:!0,get:function(){return this}})},Mu=zt,Pu=C,Tu=Z,$u=function(t,e){if(ni(e,t))return t;throw new ri("Incorrect invocation")},ku=function(t,e){var n,r=Pi(t).constructor;return void 0===r||$i(n=Pi(r)[ki])?e:Ti(n)},Eu=ya.set,xu=_a,Ru=function(t,e){try{1===arguments.length?console.error(t):console.error(t,e)}catch(t){}},Cu=Ua,Nu=Ma,Bu=nn,qu=Wa,Du=su,Au="Promise",Iu=cu.CONSTRUCTOR,Gu=cu.REJECTION_EVENT,Lu=cu.SUBCLASSING,zu=Bu.getterFor(Au),Fu=Bu.set,Yu=qu&&qu.prototype,_u=qu,Uu=Yu,Wu=vu.TypeError,Hu=vu.document,Vu=vu.process,Ju=Du.f,Ku=Ju,Xu=!!(Hu&&Hu.createEvent&&vu.dispatchEvent),Zu="unhandledrejection",Qu=function(t){var e;return!(!Tu(t)||!Pu(e=t.then))&&e},tc=function(t,e){var n,r,o,i=e.value,a=1===e.state,u=a?t.ok:t.fail,c=t.resolve,s=t.reject,l=t.domain;try{u?(a||(2===e.rejection&&ic(e),e.rejection=1),!0===u?n=i:(l&&l.enter(),n=u(i),l&&(l.exit(),o=!0)),n===t.promise?s(new Wu("Promise-chain cycle")):(r=Qu(n))?bu(r,n,c,s):c(n)):s(i)}catch(t){l&&!o&&l.exit(),s(t)}},ec=function(t,e){t.notified||(t.notified=!0,xu((function(){for(var n,r=t.reactions;n=r.get();)tc(n,t);t.notified=!1,e&&!t.rejection&&rc(t)})))},nc=function(t,e,n){var r,o;Xu?((r=Hu.createEvent("Event")).promise=e,r.reason=n,r.initEvent(t,!1,!0),vu.dispatchEvent(r)):r={promise:e,reason:n},!Gu&&(o=vu["on"+t])?o(r):t===Zu&&Ru("Unhandled promise rejection",n)},rc=function(t){bu(Eu,vu,(function(){var e,n=t.facade,r=t.value;if(oc(t)&&(e=Cu((function(){yu?Vu.emit("unhandledRejection",r,n):nc(Zu,n,r)})),t.rejection=yu||oc(t)?2:1,e.error))throw e.value}))},oc=function(t){return 1!==t.rejection&&!t.parent},ic=function(t){bu(Eu,vu,(function(){var e=t.facade;yu?Vu.emit("rejectionHandled",e):nc("rejectionhandled",e,t.value)}))},ac=function(t,e,n){return function(r){t(e,r,n)}},uc=function(t,e,n){t.done||(t.done=!0,n&&(t=n),t.value=e,t.state=2,ec(t,!0))},cc=function(t,e,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===e)throw new Wu("Promise can't be resolved itself");var r=Qu(e);r?xu((function(){var n={done:!1};try{bu(r,e,ac(cc,n,t),ac(uc,n,t))}catch(e){uc(n,e,t)}})):(t.value=e,t.state=1,ec(t,!1))}catch(e){uc({done:!1},e,t)}}};if(Iu&&(Uu=(_u=function(t){$u(this,Uu),Mu(t),bu(du,this);var e=zu(this);try{t(ac(cc,e),ac(uc,e))}catch(t){uc(e,t)}}).prototype,(du=function(t){Fu(this,{type:Au,done:!1,notified:!1,parent:!1,reactions:new Nu,rejection:!1,state:0,value:void 0})}).prototype=wu(Uu,"then",(function(t,e){var n=zu(this),r=Ju(ku(this,_u));return n.parent=!0,r.ok=!Pu(t)||t,r.fail=Pu(e)&&e,r.domain=yu?Vu.domain:void 0,0===n.state?n.reactions.add(r):xu((function(){tc(r,n)})),r.promise})),hu=function(){var t=new du,e=zu(t);this.promise=t,this.resolve=ac(cc,e),this.reject=ac(uc,e)},Du.f=Ju=function(t){return t===_u||undefined===t?new hu(t):Ku(t)},Pu(qu)&&Yu!==Object.prototype)){mu=Yu.then,Lu||wu(Yu,"then",(function(t,e){var n=this;return new _u((function(t,e){bu(mu,n,t,e)})).then(t,e)}),{unsafe:!0});try{delete Yu.constructor}catch(t){}Su&&Su(Yu,Uu)}gu({global:!0,constructor:!0,wrap:!0,forced:Iu},{Promise:_u}),Ou(_u,Au,!1),ju(Au);var sc={},lc=sc,fc=fe("iterator"),pc=Array.prototype,dc=Do,hc=_t,mc=p,gc=sc,yc=fe("iterator"),vc=function(t){if(!mc(t))return hc(t,yc)||hc(t,"@@iterator")||gc[dc(t)]},bc=dt,wc=zt,Sc=lt,Oc=At,jc=vc,Mc=TypeError,Pc=dt,Tc=lt,$c=_t,kc=Li,Ec=dt,xc=lt,Rc=At,Cc=function(t){return void 0!==t&&(lc.Array===t||pc[fc]===t)},Nc=Sr,Bc=yt,qc=function(t,e){var n=arguments.length<2?jc(t):e;if(wc(n))return Sc(bc(n,t));throw new Mc(Oc(t)+" is not iterable")},Dc=vc,Ac=function(t,e,n){var r,o;Tc(t);try{if(!(r=$c(t,"return"))){if("throw"===e)throw n;return n}r=Pc(r,t)}catch(t){o=!0,r=t}if("throw"===e)throw n;if(o)throw r;return Tc(r),n},Ic=TypeError,Gc=function(t,e){this.stopped=t,this.result=e},Lc=Gc.prototype,zc=function(t,e,n){var r,o,i,a,u,c,s,l=n&&n.that,f=!(!n||!n.AS_ENTRIES),p=!(!n||!n.IS_RECORD),d=!(!n||!n.IS_ITERATOR),h=!(!n||!n.INTERRUPTED),m=kc(e,l),g=function(t){return r&&Ac(r,"normal",t),new Gc(!0,t)},y=function(t){return f?(xc(t),h?m(t[0],t[1],g):m(t[0],t[1])):h?m(t,g):m(t)};if(p)r=t.iterator;else if(d)r=t;else{if(!(o=Dc(t)))throw new Ic(Rc(t)+" is not iterable");if(Cc(o)){for(i=0,a=Nc(t);a>i;i++)if((u=y(t[i]))&&Bc(Lc,u))return u;return new Gc(!1)}r=qc(t,o)}for(c=p?t.next:r.next;!(s=Ec(c,r)).done;){try{u=y(s.value)}catch(t){Ac(r,"throw",t)}if("object"==typeof u&&u&&Bc(Lc,u))return u}return new Gc(!1)},Fc=fe("iterator"),Yc=!1;try{var _c=0,Uc={next:function(){return{done:!!_c++}},return:function(){Yc=!0}};Uc[Fc]=function(){return this},Array.from(Uc,(function(){throw 2}))}catch(t){}var Wc=Wa,Hc=function(t,e){try{if(!e&&!Yc)return!1}catch(t){return!1}var n=!1;try{var r={};r[Fc]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(t){}return n},Vc=cu.CONSTRUCTOR||!Hc((function(t){Wc.all(t).then(void 0,(function(){}))})),Jc=dt,Kc=zt,Xc=su,Zc=Ua,Qc=zc;so({target:"Promise",stat:!0,forced:Vc},{all:function(t){var e=this,n=Xc.f(e),r=n.resolve,o=n.reject,i=Zc((function(){var n=Kc(e.resolve),i=[],a=0,u=1;Qc(t,(function(t){var c=a++,s=!1;u++,Jc(n,e,t).then((function(t){s||(s=!0,i[c]=t,--u||r(i))}),o)})),--u||r(i)}));return i.error&&o(i.value),n.promise}});var ts=so,es=cu.CONSTRUCTOR,ns=Wa,rs=gt,os=C,is=sr,as=ns&&ns.prototype;if(ts({target:"Promise",proto:!0,forced:es,real:!0},{catch:function(t){return this.then(void 0,t)}}),os(ns)){var us=rs("Promise").prototype.catch;as.catch!==us&&is(as,"catch",us,{unsafe:!0})}var cs=dt,ss=zt,ls=su,fs=Ua,ps=zc;so({target:"Promise",stat:!0,forced:Vc},{race:function(t){var e=this,n=ls.f(e),r=n.reject,o=fs((function(){var o=ss(e.resolve);ps(t,(function(t){cs(o,e,t).then(n.resolve,r)}))}));return o.error&&r(o.value),n.promise}});var ds=dt,hs=su;so({target:"Promise",stat:!0,forced:cu.CONSTRUCTOR},{reject:function(t){var e=hs.f(this);return ds(e.reject,void 0,t),e.promise}});var ms=lt,gs=Z,ys=su,vs=so,bs=cu.CONSTRUCTOR,ws=function(t,e){if(ms(t),gs(e)&&e.constructor===t)return e;var n=ys.f(t);return(0,n.resolve)(e),n.promise};function Ss(t){return null!=t&&!Number.isNaN(t)}function Os(t,n){return+Ss(n)-+Ss(t)||e.ascending(t,n)}function js(t){return isFinite(t)?t:NaN}function Ms(t){return t>0&&isFinite(t)?t:NaN}function Ps(t){return t<0&&isFinite(t)?t:NaN}function Ts(t,e){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return"function"==typeof e?e(t):e;const n=t.getUTCHours(),r=t.getUTCMinutes(),o=t.getUTCSeconds(),i=t.getUTCMilliseconds();return`${a=t.getUTCFullYear(),a<0?`-${$s(-a,6)}`:a>9999?`+${$s(a,6)}`:$s(a,4)}-${$s(t.getUTCMonth()+1,2)}-${$s(t.getUTCDate(),2)}${n||r||o||i?`T${$s(n,2)}:${$s(r,2)}${o||i?`:${$s(o,2)}${i?`.${$s(i,3)}`:""}`:""}Z`:""}`;var a}function $s(t,e){return`${t}`.padStart(e,"0")}gt("Promise"),vs({target:"Promise",stat:!0,forced:bs},{resolve:function(t){return ws(this,t)}});const ks=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function Es(t,e){return ks.test(t+="")?new Date(t):"function"==typeof e?e(t):e}const xs=new Map([["second",e.timeSecond],["minute",e.timeMinute],["hour",e.timeHour],["day",e.timeDay],["week",e.timeWeek],["month",e.timeMonth],["quarter",e.timeMonth.every(3)],["half",e.timeMonth.every(6)],["year",e.timeYear],["monday",e.timeMonday],["tuesday",e.timeTuesday],["wednesday",e.timeWednesday],["thursday",e.timeThursday],["friday",e.timeFriday],["saturday",e.timeSaturday],["sunday",e.timeSunday]]),Rs=new Map([["second",e.utcSecond],["minute",e.utcMinute],["hour",e.utcHour],["day",e.utcDay],["week",e.utcWeek],["month",e.utcMonth],["quarter",e.utcMonth.every(3)],["half",e.utcMonth.every(6)],["year",e.utcYear],["monday",e.utcMonday],["tuesday",e.utcTuesday],["wednesday",e.utcWednesday],["thursday",e.utcThursday],["friday",e.utcFriday],["saturday",e.utcSaturday],["sunday",e.utcSunday]]);function Cs(t){const e=xs.get(`${t}`.toLowerCase());if(!e)throw new Error(`unknown interval: ${t}`);return e}function Ns(t){const e=Rs.get(`${t}`.toLowerCase());if(!e)throw new Error(`unknown interval: ${t}`);return e}const Bs=Object.getPrototypeOf(Uint8Array),qs=Object.prototype.toString,Ds=t=>null==t?t:`${t}`,As=t=>()=>t;function Is(t){return t instanceof Bs?t:Us(t,Gs,Float64Array)}function Gs(t){return null==t?NaN:Number(t)}function Ls(t){return Us(t,zs)}function zs(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?Es(t):null==t||isNaN(t=+t)?void 0:new Date(t)}function Fs(t,n){return void 0===t&&(t=n),null===t?[void 0,"none"]:function(t){return"string"==typeof t&&(t=t.toLowerCase().trim(),"none"===t||"currentcolor"===t||t.startsWith("url(")&&t.endsWith(")")||t.startsWith("var(")&&t.endsWith(")")||null!==e.color(t))}(t)?[void 0,t]:[t,void 0]}function Ys(t,e){return void 0===t&&(t=e),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function _s(t){return null==t||t instanceof Array||t instanceof Bs?t:Array.from(t)}function Us(t,e,n=Array){return null==t?t:t instanceof n?t.map(e):n.from(t,e)}function Ws(t){return t?.toString===qs}function Hs(t){return Ws(t)&&(void 0!==t.type||void 0!==t.domain)}function Vs(t,n){if(null!=t){if("number"==typeof t){0<t&&t<1&&Number.isInteger(1/t)&&(t=-1/t);const n=Math.abs(t);return t<0?{floor:t=>Math.floor(t*n)/n,offset:t=>(t*n+1)/n,range:(t,r)=>e.range(Math.ceil(t*n),r*n).map((t=>t/n))}:{floor:t=>Math.floor(t/n)*n,offset:t=>t+n,range:(t,r)=>e.range(Math.ceil(t/n),r/n).map((t=>t*n))}}if("string"==typeof t)return("time"===n?Cs:Ns)(t);if("function"!=typeof t.floor)throw new Error("invalid interval; missing floor method");if("function"!=typeof t.offset)throw new Error("invalid interval; missing offset method");return t}}function Js(t,e){if((t=Vs(t,e))&&"function"!=typeof t.range)throw new Error("invalid interval: missing range method");return t}function Ks(t){for(const e of t){if(null==e)continue;const t=typeof e;return"string"===t||"boolean"===t}}function Xs(t){for(const e of t)if(null!=e)return e instanceof Date}function Zs(t){for(const e of t)if(null!=e)return"string"==typeof e&&isNaN(e)&&Es(e)}function Qs(t){for(const e of t)if(null!=e){if("string"!=typeof e)return!1;if(e.trim())return!isNaN(e)}}function tl(t){return null==t||function(t){return/^\s*none\s*$/i.test(t)}(t)}function el(t){if(null==t)return;const n=t[0],r=t[t.length-1];return e.descending(n,r)}const nl=Symbol("position"),rl=Symbol("color"),ol=Symbol("radius"),il=Symbol("length"),al=Symbol("opacity"),ul=Symbol("symbol"),cl=new Map([["x",nl],["y",nl],["fx",nl],["fy",nl],["r",ol],["color",rl],["opacity",al],["symbol",ul],["length",il]]),sl=2/Math.sqrt(3),ll={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*sl,o=r/2;t.moveTo(0,r),t.lineTo(n,o),t.lineTo(n,-o),t.lineTo(0,-r),t.lineTo(-n,-o),t.lineTo(-n,o),t.closePath()}},fl=new Map([["asterisk",e.symbolAsterisk],["circle",e.symbolCircle],["cross",e.symbolCross],["diamond",e.symbolDiamond],["diamond2",e.symbolDiamond2],["hexagon",ll],["plus",e.symbolPlus],["square",e.symbolSquare],["square2",e.symbolSquare2],["star",e.symbolStar],["times",e.symbolTimes],["triangle",e.symbolTriangle],["triangle2",e.symbolTriangle2],["wye",e.symbolWye]]);function pl(t){if(null==t||function(t){return t&&"function"==typeof t.draw}(t))return t;const e=fl.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}function dl(t){console.warn(t)}const hl=Math.PI,ml=2*hl;function gl({projection:t,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n}={},u){if(null==t)return;if("function"==typeof t.stream)return t;let c,s,l="frame";if(Ws(t)){let e;if(({type:t,domain:s,inset:e,insetTop:r=(void 0!==e?e:r),insetRight:o=(void 0!==e?e:o),insetBottom:i=(void 0!==e?e:i),insetLeft:a=(void 0!==e?e:a),clip:l=l,...c}=t),null==t)return}"function"!=typeof t&&({type:t}=function(t){switch(`${t}`.toLowerCase()){case"albers-usa":return yl(e.geoAlbersUsa,.7463,.4673);case"albers":return vl(e.geoAlbers,.7463,.4673);case"azimuthal-equal-area":return yl(e.geoAzimuthalEqualArea,4,4);case"azimuthal-equidistant":return yl(e.geoAzimuthalEquidistant,ml,ml);case"conic-conformal":return vl(e.geoConicConformal,ml,ml);case"conic-equal-area":return vl(e.geoConicEqualArea,6.1702,2.9781);case"conic-equidistant":return vl(e.geoConicEquidistant,7.312,3.6282);case"equal-earth":return yl(e.geoEqualEarth,5.4133,2.6347);case"equirectangular":return yl(e.geoEquirectangular,ml,hl);case"gnomonic":return yl(e.geoGnomonic,3.4641,3.4641);case"identity":return{type:bl};case"reflect-y":return{type:wl};case"mercator":return yl(e.geoMercator,ml,ml);case"orthographic":return yl(e.geoOrthographic,2,2);case"stereographic":return yl(e.geoStereographic,2,2);case"transverse-mercator":return yl(e.geoTransverseMercator,ml,ml);default:throw new Error(`unknown projection type: ${t}`)}}(t));const{width:f,height:p,marginLeft:d,marginRight:h,marginTop:m,marginBottom:g}=u,y=f-d-h-a-o,v=p-m-g-r-i;if(t=t?.({width:y,height:v,clip:l,...c}),null==t)return;l=function(t,n,r,o,i){if(!1===t||null==t||"number"==typeof t)return t=>t;!0===t&&(t="frame");if("frame"===`${t}`.toLowerCase())return e.geoClipRectangle(n,r,o,i);throw new Error(`unknown projection clip type: ${t}`)}(l,d,m,f-h,p-g);let b,w=d+a,S=m+r;if(null!=s){const[[n,r],[o,i]]=e.geoPath(t).bounds(s),a=Math.min(y/(o-n),v/(i-r));a>0?(w-=(a*(n+o)-y)/2,S-=(a*(r+i)-v)/2,b=e.geoTransform({point(t,e){this.stream.point(t*a+w,e*a+S)}})):dl("Warning: the projection could not be fit to the specified domain; using the default scale.")}return b??=0===w&&0===S?bl():e.geoTransform({point(t,e){this.stream.point(t+w,e+S)}}),{stream:e=>t.stream(b.stream(l(e)))}}function yl(t,e,n){return{type:({width:r,height:o,rotate:i,precision:a=.15,clip:u})=>{const c=t();return null!=a&&c.precision?.(a),null!=i&&c.rotate?.(i),"number"==typeof u&&c.clipAngle?.(u),c.scale(Math.min(r/e,o/n)),c.translate([r/2,o/2]),c},aspectRatio:n/e}}function vl(t,e,n){const{type:r,aspectRatio:o}=yl(t,e,n);return{type:t=>{const{parallels:e,domain:n,width:o,height:i}=t,a=r(t);return null!=e&&(a.parallels(e),void 0===n&&a.fitSize([o,i],{type:"Sphere"})),a},aspectRatio:o}}const bl=As({stream:t=>t}),wl=As(e.geoTransform({point(t,e){this.stream.point(t,-e)}}));function Sl(t={},e,n){const{document:r=("undefined"!=typeof window?window.document:void 0)}=t;return{document:r,className:n,projection:gl(t,e)}}function Ol(t,{document:n}){return e.select(e.creator(t).call(n.documentElement))}const jl=new Map([["accent",e.schemeAccent],["category10",e.schemeCategory10],["dark2",e.schemeDark2],["paired",e.schemePaired],["pastel1",e.schemePastel1],["pastel2",e.schemePastel2],["set1",e.schemeSet1],["set2",e.schemeSet2],["set3",e.schemeSet3],["tableau10",e.schemeTableau10],["brbg",Pl(e.schemeBrBG,e.interpolateBrBG)],["prgn",Pl(e.schemePRGn,e.interpolatePRGn)],["piyg",Pl(e.schemePiYG,e.interpolatePiYG)],["puor",Pl(e.schemePuOr,e.interpolatePuOr)],["rdbu",Pl(e.schemeRdBu,e.interpolateRdBu)],["rdgy",Pl(e.schemeRdGy,e.interpolateRdGy)],["rdylbu",Pl(e.schemeRdYlBu,e.interpolateRdYlBu)],["rdylgn",Pl(e.schemeRdYlGn,e.interpolateRdYlGn)],["spectral",Pl(e.schemeSpectral,e.interpolateSpectral)],["burd",Tl(e.schemeRdBu,e.interpolateRdBu)],["buylrd",Tl(e.schemeRdYlBu,e.interpolateRdYlBu)],["blues",Ml(e.schemeBlues,e.interpolateBlues)],["greens",Ml(e.schemeGreens,e.interpolateGreens)],["greys",Ml(e.schemeGreys,e.interpolateGreys)],["oranges",Ml(e.schemeOranges,e.interpolateOranges)],["purples",Ml(e.schemePurples,e.interpolatePurples)],["reds",Ml(e.schemeReds,e.interpolateReds)],["turbo",$l(e.interpolateTurbo)],["viridis",$l(e.interpolateViridis)],["magma",$l(e.interpolateMagma)],["inferno",$l(e.interpolateInferno)],["plasma",$l(e.interpolatePlasma)],["cividis",$l(e.interpolateCividis)],["cubehelix",$l(e.interpolateCubehelixDefault)],["warm",$l(e.interpolateWarm)],["cool",$l(e.interpolateCool)],["bugn",Ml(e.schemeBuGn,e.interpolateBuGn)],["bupu",Ml(e.schemeBuPu,e.interpolateBuPu)],["gnbu",Ml(e.schemeGnBu,e.interpolateGnBu)],["orrd",Ml(e.schemeOrRd,e.interpolateOrRd)],["pubu",Ml(e.schemePuBu,e.interpolatePuBu)],["pubugn",Ml(e.schemePuBuGn,e.interpolatePuBuGn)],["purd",Ml(e.schemePuRd,e.interpolatePuRd)],["rdpu",Ml(e.schemeRdPu,e.interpolateRdPu)],["ylgn",Ml(e.schemeYlGn,e.interpolateYlGn)],["ylgnbu",Ml(e.schemeYlGnBu,e.interpolateYlGnBu)],["ylorbr",Ml(e.schemeYlOrBr,e.interpolateYlOrBr)],["ylorrd",Ml(e.schemeYlOrRd,e.interpolateYlOrRd)],["rainbow",kl(e.interpolateRainbow)],["sinebow",kl(e.interpolateSinebow)]]);function Ml(t,n){return({length:r})=>1===r?[t[3][1]]:2===r?[t[3][1],t[3][2]]:(r=Math.max(3,Math.floor(r)))>9?e.quantize(n,r):t[r]}function Pl(t,n){return({length:r})=>2===r?[t[3][0],t[3][2]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize(n,r):t[r]}function Tl(t,n){return({length:r})=>2===r?[t[3][2],t[3][0]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize((t=>n(1-t)),r):t[r].slice().reverse()}function $l(t){return({length:n})=>e.quantize(t,Math.max(2,Math.floor(n)))}function kl(t){return({length:n})=>e.quantize(t,Math.floor(n)+1).slice(0,-1)}function El(t){const e=`${t}`.toLowerCase();if(!jl.has(e))throw new Error(`unknown ordinal scheme: ${e}`);return jl.get(e)}function xl(t,e){const n=El(t),r="function"==typeof n?n({length:e}):n;return r.length!==e?r.slice(0,e):r}const Rl=new Map([["brbg",e.interpolateBrBG],["prgn",e.interpolatePRGn],["piyg",e.interpolatePiYG],["puor",e.interpolatePuOr],["rdbu",e.interpolateRdBu],["rdgy",e.interpolateRdGy],["rdylbu",e.interpolateRdYlBu],["rdylgn",e.interpolateRdYlGn],["spectral",e.interpolateSpectral],["burd",t=>e.interpolateRdBu(1-t)],["buylrd",t=>e.interpolateRdYlBu(1-t)],["blues",e.interpolateBlues],["greens",e.interpolateGreens],["greys",e.interpolateGreys],["purples",e.interpolatePurples],["reds",e.interpolateReds],["oranges",e.interpolateOranges],["turbo",e.interpolateTurbo],["viridis",e.interpolateViridis],["magma",e.interpolateMagma],["inferno",e.interpolateInferno],["plasma",e.interpolatePlasma],["cividis",e.interpolateCividis],["cubehelix",e.interpolateCubehelixDefault],["warm",e.interpolateWarm],["cool",e.interpolateCool],["bugn",e.interpolateBuGn],["bupu",e.interpolateBuPu],["gnbu",e.interpolateGnBu],["orrd",e.interpolateOrRd],["pubugn",e.interpolatePuBuGn],["pubu",e.interpolatePuBu],["purd",e.interpolatePuRd],["rdpu",e.interpolateRdPu],["ylgnbu",e.interpolateYlGnBu],["ylgn",e.interpolateYlGn],["ylorbr",e.interpolateYlOrBr],["ylorrd",e.interpolateYlOrRd],["rainbow",e.interpolateRainbow],["sinebow",e.interpolateSinebow]]);function Cl(t){const e=`${t}`.toLowerCase();if(!Rl.has(e))throw new Error(`unknown quantitative scheme: ${e}`);return Rl.get(e)}const Nl=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function Bl(t){return null!=t&&Nl.has(`${t}`.toLowerCase())}const ql=t=>e=>t(1-e),Dl=[0,1],Al=new Map([["number",e.interpolateNumber],["rgb",e.interpolateRgb],["hsl",e.interpolateHsl],["hcl",e.interpolateHcl],["lab",e.interpolateLab]]);function Il(t){const e=`${t}`.toLowerCase();if(!Al.has(e))throw new Error(`unknown interpolator: ${e}`);return Al.get(e)}function Gl(t,n,r,{type:o,nice:i,clamp:a,zero:u,domain:c=Yl(t,r),unknown:s,round:l,scheme:f,interval:p,range:d=(cl.get(t)===ol?Ul(r,c):cl.get(t)===il?Wl(r,c):cl.get(t)===al?Dl:void 0),interpolate:h=(cl.get(t)===rl?null==f&&void 0!==d?e.interpolateRgb:Cl(void 0!==f?f:"cyclical"===o?"rainbow":"turbo"):l?e.interpolateRound:e.interpolateNumber),reverse:m}){if(p=Js(p,o),"cyclical"!==o&&"sequential"!==o||(o="linear"),m=!!m,"function"!=typeof h&&(h=Il(h)),1===h.length?(m&&(h=ql(h),m=!1),void 0===d&&2===(d=Float64Array.from(c,((t,e)=>e/(c.length-1)))).length&&(d=Dl),n.interpolate((d===Dl?As:Jl)(h))):n.interpolate(h),u){const[t,n]=e.extent(c);(t>0||n<0)&&(c=function(t,e=Array){return t instanceof e?t.slice():e.from(t)}(c),el(c)!==Math.sign(t)?c[c.length-1]=0:c[0]=0)}return m&&(c=e.reverse(c)),n.domain(c).unknown(s),i&&(n.nice(function(t,e){return!0===t?void 0:"number"==typeof t?t:function(t,e){if((t=Js(t,e))&&"function"!=typeof t.ceil)throw new Error("invalid interval: missing ceil method");return t}(t,e)}(i,o)),c=n.domain()),void 0!==d&&n.range(d),a&&n.clamp(a),{type:o,domain:c,range:d,scale:n,interpolate:h,interval:p}}function Ll(t,n,{exponent:r=1,...o}){return Gl(t,e.scalePow().exponent(r),n,{...o,type:"pow"})}function zl(t,n,{domain:r=[0],unknown:o,scheme:i="rdylbu",interpolate:a,range:u=(void 0!==a?e.quantize(a,r.length+1):cl.get(t)===rl?xl(i,r.length+1):void 0),reverse:c}){const s=el(r=_s(r));if(!isNaN(s)&&!function(t,n){for(let r=1,o=t.length,i=t[0];r<o;++r){const o=e.descending(i,i=t[r]);if(0!==o&&o!==n)return!1}return!0}(r,s))throw new Error(`the ${t} scale has a non-monotonic domain`);return c&&(u=e.reverse(u)),{type:"threshold",scale:e.scaleThreshold(s<0?e.reverse(r):r,void 0===u?[]:u).unknown(o),domain:r,range:u}}function Fl(t,n=js){return t.length?[e.min(t,(({value:t})=>void 0===t?t:e.min(t,n))),e.max(t,(({value:t})=>void 0===t?t:e.max(t,n)))]:[0,1]}function Yl(t,e){const n=cl.get(t);return(n===ol||n===al||n===il?_l:Fl)(e)}function _l(t){return[0,t.length?e.max(t,(({value:t})=>void 0===t?t:e.max(t,js))):1]}function Ul(t,n){const r=t.find((({radius:t})=>void 0!==t));if(void 0!==r)return[0,r.radius];const o=e.quantile(t,.5,(({value:t})=>void 0===t?NaN:e.quantile(t,.25,Ms))),i=n.map((t=>3*Math.sqrt(t/o))),a=30/e.max(i);return a<1?i.map((t=>t*a)):i}function Wl(t,n){const r=e.median(t,(({value:t})=>void 0===t?NaN:e.median(t,Math.abs))),o=n.map((t=>12*t/r)),i=60/e.max(o);return i<1?o.map((t=>t*i)):o}function Hl(t){for(const{value:e}of t)if(void 0!==e)for(let n of e){if(n>0)return Fl(t,Ms);if(n<0)return Fl(t,Ps)}return[1,10]}function Vl(t){const e=[];for(const{value:n}of t)if(void 0!==n)for(const t of n)e.push(t);return e}function Jl(t){return(e,n)=>r=>t(e+r*(n-e))}function Kl(t,n,r,o,{type:i,nice:a,clamp:u,domain:c=Fl(o),unknown:s,pivot:l=0,scheme:f,range:p,symmetric:d=!0,interpolate:h=(cl.get(t)===rl?null==f&&void 0!==p?e.interpolateRgb:Cl(void 0!==f?f:"rdbu"):e.interpolateNumber),reverse:m}){l=+l;let[g,y]=c;if(e.descending(g,y)<0&&([g,y]=[y,g],m=!m),g=Math.min(g,l),y=Math.max(y,l),"function"!=typeof h&&(h=Il(h)),void 0!==p&&(h=1===h.length?Jl(h)(...p):e.piecewise(h,p)),m&&(h=ql(h)),d){const t=r.apply(l),e=t-r.apply(g),n=r.apply(y)-t;e<n?g=r.invert(t-n):e>n&&(y=r.invert(t+e))}return n.domain([g,l,y]).unknown(s).interpolator(h),u&&n.clamp(u),a&&n.nice(a),{type:i,domain:[g,y],pivot:l,interpolate:h,scale:n}}function Xl(t,n,{exponent:r=1,...o}){return Kl(t,e.scaleDivergingPow().exponent(r=+r),function(t){return.5===t?ef:{apply:e=>Math.sign(e)*Math.pow(Math.abs(e),t),invert:e=>Math.sign(e)*Math.pow(Math.abs(e),1/t)}}(r),n,{...o,type:"diverging-pow"})}function Zl(t,n,{constant:r=1,...o}){return Kl(t,e.scaleDivergingSymlog().constant(r=+r),function(t){return{apply:e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),invert:e=>Math.sign(e)*Math.expm1(Math.abs(e))*t}}(r),n,o)}const Ql={apply:t=>t,invert:t=>t},tf={apply:Math.log,invert:Math.exp},ef={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function nf(t,e,n,r){return Gl(t,e,n,r)}const rf=Symbol("ordinal");function of(t,n,r,{type:o,interval:i,domain:a,range:u,reverse:c,hint:s}){return i=Js(i,o),void 0===a&&(a=cf(r,i,t)),"categorical"!==o&&o!==rf||(o="ordinal"),c&&(a=e.reverse(a)),n.domain(a),void 0!==u&&("function"==typeof u&&(u=u(a)),n.range(u)),{type:o,domain:a,range:u,scale:n,hint:s,interval:i}}function af(t,n,{type:r,interval:o,domain:i,range:a,scheme:u,unknown:c,...s}){let l;if(o=Js(o,r),void 0===i&&(i=cf(n,o,t)),cl.get(t)===ul)l=function(t){return{fill:sf(t,"fill"),stroke:sf(t,"stroke")}}(n),a=void 0===a?function(t){return tl(t.fill)?e.symbolsStroke:e.symbolsFill}(l):Us(a,pl);else if(cl.get(t)===rl&&(void 0!==a||"ordinal"!==r&&r!==rf||(a=function(t,e="greys"){const n=new Set,[r,o]=xl(e,2);for(const e of t)if(null!=e)if(!0===e)n.add(o);else{if(!1!==e)return;n.add(r)}return[...n]}(i,u),void 0!==a&&(u=void 0)),void 0===u&&void 0===a&&(u="ordinal"===r?"turbo":"tableau10"),void 0!==u))if(void 0!==a){const t=Cl(u),n=a[0],r=a[1]-a[0];a=({length:o})=>e.quantize((e=>t(n+r*e)),o)}else a=El(u);if(c===e.scaleImplicit)throw new Error(`implicit unknown on ${t} scale is not supported`);return of(t,e.scaleOrdinal().unknown(c),n,{...s,type:r,domain:i,range:a,hint:l})}function uf(t,e,n,r){let{round:o}=n;return void 0!==o&&t.round(o=!!o),(t=of(r,t,e,n)).round=o,t}function cf(t,n,r){const o=new e.InternSet;for(const{value:e,domain:n}of t){if(void 0!==n)return n();if(void 0!==e)for(const t of e)o.add(t)}if(void 0!==n){const[t,r]=e.extent(o).map(n.floor,n);return n.range(t,n.offset(r))}if(o.size>1e4&&cl.get(r)===nl)throw new Error(`implicit ordinal domain of ${r} scale has more than 10,000 values`);return e.sort(o,Os)}function sf(t,e){let n;for(const{hint:r}of t){const t=r?.[e];if(void 0!==t)if(void 0===n)n=t;else if(n!==t)return}return n}function lf(t,n,r){return function(t,n=[],r={}){const o=function(t,e,{type:n,domain:r,range:o,scheme:i,pivot:a,projection:u}){if("fx"===t||"fy"===t)return"band";"x"!==t&&"y"!==t||null==u||(n=pf);for(const{type:t}of e)if(void 0!==t)if(void 0===n)n=t;else if(n!==t)throw new Error(`scale incompatible with channel: ${n} !== ${t}`);if(n===pf)return;if(void 0!==n)return n;if(void 0===r&&!e.some((({value:t})=>void 0!==t)))return;const c=cl.get(t);if(c===ol)return"sqrt";if(c===al||c===il)return"linear";if(c===ul)return"ordinal";if((r||o||[]).length>2)return df(c);if(void 0!==r)return Ks(r)?df(c):Xs(r)?"utc":c!==rl||null==a&&!Bl(i)?"linear":"diverging";const s=e.map((({value:t})=>t)).filter((t=>void 0!==t));return s.some(Ks)?df(c):s.some(Xs)?"utc":c!==rl||null==a&&!Bl(i)?"linear":"diverging"}(t,n,r);if(void 0===r.type&&void 0===r.domain&&void 0===r.range&&null==r.interval&&"fx"!==t&&"fy"!==t&&hf({type:o})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some(Xs)?dl(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${ff(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${ff(o)}".`):e.some(Zs)?dl(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${ff(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${ff(o)}".`):e.some(Qs)&&dl(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${ff(o)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${ff(o)}".`)}switch(r.type=o,o){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":r=mf(n,r,Is);break;case"identity":switch(cl.get(t)){case nl:r=mf(n,r,Is);break;case ul:r=mf(n,r,gf)}break;case"utc":case"time":r=mf(n,r,Ls)}switch(o){case"diverging":return function(t,n,r){return Kl(t,e.scaleDiverging(),Ql,n,r)}(t,n,r);case"diverging-sqrt":return function(t,e,n){return Xl(t,e,{...n,exponent:.5})}(t,n,r);case"diverging-pow":return Xl(t,n,r);case"diverging-log":return function(t,n,{base:r=10,pivot:o=1,domain:i=Fl(n,o<0?Ps:Ms),...a}){return Kl(t,e.scaleDivergingLog().base(r=+r),tf,n,{domain:i,pivot:o,...a})}(t,n,r);case"diverging-symlog":return Zl(t,n,r);case"categorical":case"ordinal":case rf:return af(t,n,r);case"cyclical":case"sequential":case"linear":return function(t,n,r){return Gl(t,e.scaleLinear(),n,r)}(t,n,r);case"sqrt":return function(t,e,n){return Ll(t,e,{...n,exponent:.5})}(t,n,r);case"threshold":return zl(t,0,r);case"quantile":return function(t,n,{range:r,quantiles:o=(void 0===r?5:(r=[...r]).length),n:i=o,scheme:a="rdylbu",domain:u=Vl(n),unknown:c,interpolate:s,reverse:l}){return void 0===r&&(r=void 0!==s?e.quantize(s,i):cl.get(t)===rl?xl(a,i):void 0),u.length>0&&(u=e.scaleQuantile(u,void 0===r?{length:i}:r).quantiles()),zl(t,0,{domain:u,range:r,reverse:l,unknown:c})}(t,n,r);case"quantize":return function(t,n,{range:r,n:o=(void 0===r?5:(r=[...r]).length),scheme:i="rdylbu",domain:a=Yl(t,n),unknown:u,interpolate:c,reverse:s}){const[l,f]=e.extent(a);let p;return void 0===r?(p=e.ticks(l,f,o),p[0]<=l&&p.splice(0,1),p[p.length-1]>=f&&p.pop(),o=p.length+1,r=void 0!==c?e.quantize(c,o):cl.get(t)===rl?xl(i,o):void 0):(p=e.quantize(e.interpolateNumber(l,f),o+1).slice(1,-1),l instanceof Date&&(p=p.map((t=>new Date(t))))),el(_s(a))<0&&p.reverse(),zl(t,0,{domain:p,range:r,reverse:s,unknown:u})}(t,n,r);case"pow":return Ll(t,n,r);case"log":return function(t,n,{base:r=10,domain:o=Hl(n),...i}){return Gl(t,e.scaleLog().base(r),n,{...i,domain:o})}(t,n,r);case"symlog":return function(t,n,{constant:r=1,...o}){return Gl(t,e.scaleSymlog().constant(r),n,o)}(t,n,r);case"utc":return function(t,n,r){return nf(t,e.scaleUtc(),n,r)}(t,n,r);case"time":return function(t,n,r){return nf(t,e.scaleTime(),n,r)}(t,n,r);case"point":return function(t,n,{align:r=.5,padding:o=.5,...i}){return uf(e.scalePoint().align(r).padding(o),n,i,t)}(t,n,r);case"band":return function(t,n,{align:r=.5,padding:o=.1,paddingInner:i=o,paddingOuter:a=("fx"===t||"fy"===t?0:o),...u}){return uf(e.scaleBand().align(r).paddingInner(i).paddingOuter(a),n,u,t)}(t,n,r);case"identity":return cl.get(t)===nl?{type:"identity",scale:e.scaleIdentity()}:{type:"identity"};case void 0:return;default:throw new Error(`unknown scale type: ${o}`)}}(t,void 0===r?void 0:[{hint:r}],{...n})}function ff(t){return"symbol"==typeof t?t.description:t}const pf={toString:()=>"projection"};function df(t){switch(t){case nl:return"point";case rl:return rf;default:return"ordinal"}}function hf({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===rf}function mf(t,{domain:e,...n},r){for(const e of t)void 0!==e.value&&(e.value=r(e.value));return{domain:void 0===e?e:r(e),...n}}function gf(t){return Us(t,pl)}const yf=function(t){let e,n;return(...r)=>((n?.length!==r.length||n.some(((t,e)=>t!==r[e])))&&(n=r,e=t(...r)),e)}((t=>new Intl.NumberFormat(t)));function vf(t){return Ts(t,"Invalid Date")}function bf(t,e){if((t=Ds(t))!==e)return t}!function(t="en-US"){const e=function(t="en-US"){const e=yf(t);return t=>null==t||isNaN(t)?void 0:e.format(t)}(t)}();const wf=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function Sf(t){if(void 0===t)return"plot-d6a7b5";if(t=`${t}`,!wf.test(t))throw new Error(`invalid class name: ${t}`);return t}function Of(t,e){if("string"==typeof e)t.property("style",e);else if(null!=e)for(const n of t)Object.assign(n.style,e)}function jf(t){return hf(t)&&void 0===t.interval?void 0:"tabular-nums"}function Mf(t,e){if(null==e)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function Pf(t,n={},r){let{columns:o,tickFormat:i,fontVariant:a=jf(t),swatchSize:u=15,swatchWidth:c=u,swatchHeight:s=u,marginLeft:l=0,className:f,style:p,width:d}=n;const h=Sl(n);f=Sf(f),i=function(t,n){return void 0===t?Xs(n)?vf:Ds:"function"==typeof t?t:("string"==typeof t?Xs(n)?e.utcFormat:e.format:As)(t)}(i,t.domain);const m=Ol("div",h).attr("class",`${f}-swatches ${f}-swatches-${null!=o?"columns":"wrap"}`);let g;return null!=o?(g=`.${f}-swatches-columns .${f}-swatch {\n  display: flex;\n  align-items: center;\n  break-inside: avoid;\n  padding-bottom: 1px;\n}\n.${f}-swatches-columns .${f}-swatch::before {\n  flex-shrink: 0;\n}\n.${f}-swatches-columns .${f}-swatch-label {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}`,m.style("columns",o).selectAll().data(t.domain).enter().append("div").attr("class",`${f}-swatch`).call(r,t,c,s).call((t=>t.append("div").attr("class",`${f}-swatch-label`).attr("title",i).text(i)))):(g=`.${f}-swatches-wrap {\n  display: flex;\n  align-items: center;\n  min-height: 33px;\n  flex-wrap: wrap;\n}\n.${f}-swatches-wrap .${f}-swatch {\n  display: inline-flex;\n  align-items: center;\n  margin-right: 1em;\n}`,m.selectAll().data(t.domain).enter().append("span").attr("class",`${f}-swatch`).call(r,t,c,s).append((function(){return this.ownerDocument.createTextNode(i.apply(this,arguments))}))),m.call((t=>t.insert("style","*").text(`.${f}-swatches {\n  font-family: system-ui, sans-serif;\n  font-size: 10px;\n  margin-bottom: 0.5em;\n}\n.${f}-swatch > svg {\n  margin-right: 0.5em;\n  overflow: visible;\n}\n${g}`))).style("margin-left",l?+l+"px":null).style("width",void 0===d?null:+d+"px").style("font-variant",bf(a,"normal")).call(Of,p).node()}const Tf=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:r=1,stroke:o=(void 0!==t.hint?.stroke?t.hint.stroke:tl(n)?"currentColor":"none"),strokeOpacity:i=1,strokeWidth:a=1.5,r:u=4.5,...c}={},s){const[l,f]=Fs(n),[p,d]=Fs(o),h=Mf(s,l),m=Mf(s,p),g=u*u*Math.PI;return r=Ys(r)[1],i=Ys(i)[1],a=Ys(a)[1],Pf(t,c,((n,o,u,c)=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("width",u).attr("height",c).attr("fill","color"===l?t=>h.scale(t):f).attr("fill-opacity",r).attr("stroke","color"===p?t=>m.scale(t):d).attr("stroke-opacity",i).attr("stroke-width",a).append("path").attr("d",(n=>{const r=e.pathRound();return t.scale(n).draw(r,g),r}))))}],["color",kf],["opacity",function({type:t,interpolate:n,...r},{legend:o=!0,color:i=e.rgb(0,0,0),...a}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===o&&(o="ramp");if("ramp"!==`${o}`.toLowerCase())throw new Error(`${o} opacity legends are not supported`);return kf({type:t,...r,interpolate:Ef(i)},{legend:o,...a})}]]);function $f({className:t,...e},{label:n,ticks:r,tickFormat:o}={},i){return function(t={},...e){let n=t;for(const r of e)for(const e in r)if(void 0===n[e]){const o=r[e];n===t?n={...n,[e]:o}:n[e]=o}return n}(i,{className:t,...e},{label:n,ticks:r,tickFormat:o})}function kf(t,{legend:n=!0,...r}){if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${n}`.toLowerCase()){case"swatches":return function(t,{opacity:e,...n}={}){if(!hf(t)&&!function({type:t}){return"threshold"===t}(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return Pf(t,n,((t,n,r,o)=>t.append("svg").attr("width",r).attr("height",o).attr("fill",n.scale).attr("fill-opacity",Ys(e)[1]).append("rect").attr("width","100%").attr("height","100%")))}(t,r);case"ramp":return function(t,n){let{label:r=t.label,tickSize:o=6,width:i=240,height:a=44+o,marginTop:u=18,marginRight:c=0,marginBottom:s=16+o,marginLeft:l=0,style:f,ticks:p=(i-l-c)/64,tickFormat:d,fontVariant:h=jf(t),round:m=!0,opacity:g,className:y}=n;const v=Sl(n);y=Sf(y),g=Ys(g)[1],null===d&&(d=()=>null);const b=Ol("svg",v).attr("class",`${y}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",a).attr("viewBox",`0 0 ${i} ${a}`).call((t=>t.append("style").text(`.${y}-ramp {\n  display: block;\n  background: white;\n  height: auto;\n  height: intrinsic;\n  max-width: 100%;\n  overflow: visible;\n}\n.${y}-ramp text {\n  white-space: pre;\n}`))).call(Of,f);let w,S=t=>t.selectAll(".tick line").attr("y1",u+s-a);const O=m?(t,e)=>t.rangeRound(e):(t,e)=>t.range(e),{type:j,domain:M,range:P,interpolate:T,scale:$,pivot:k}=t;if(T){const t=void 0===P?T:e.piecewise(1===T.length?Jl(T):T,P);w=O($.copy(),e.quantize(e.interpolateNumber(l,i-c),Math.min(M.length+(void 0!==k),void 0===P?1/0:P.length)));const n=256,r=v.document.createElement("canvas");r.width=n,r.height=1;const o=r.getContext("2d");for(let e=0,r=n-1;e<n;++e)o.fillStyle=t(e/r),o.fillRect(e,0,1,1);b.append("image").attr("opacity",g).attr("x",l).attr("y",u).attr("width",i-l-c).attr("height",a-u-s).attr("preserveAspectRatio","none").attr("xlink:href",r.toDataURL())}else if("threshold"===j){const t=M,n=void 0===d?t=>t:"string"==typeof d?e.format(d):d;w=O(e.scaleLinear().domain([-1,P.length-1]),[l,i-c]),b.append("g").attr("fill-opacity",g).selectAll().data(P).enter().append("rect").attr("x",((t,e)=>w(e-1))).attr("y",u).attr("width",((t,e)=>w(e)-w(e-1))).attr("height",a-u-s).attr("fill",(t=>t)),p=Us(t,((t,e)=>e)),d=e=>n(t[e],e)}else w=O(e.scaleBand().domain(M),[l,i-c]),b.append("g").attr("fill-opacity",g).selectAll().data(M).enter().append("rect").attr("x",w).attr("y",u).attr("width",Math.max(0,w.bandwidth()-1)).attr("height",a-u-s).attr("fill",$),S=()=>{};return b.append("g").attr("transform",`translate(0,${a-s})`).call(e.axisBottom(w).ticks(Array.isArray(p)?null:p,"string"==typeof d?d:void 0).tickFormat("function"==typeof d?d:void 0).tickSize(o).tickValues(Array.isArray(p)?p:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",bf(h,"normal")).call(S).call((t=>t.select(".domain").remove())),void 0!==r&&b.append("text").attr("x",l).attr("y",u-6).attr("fill","currentColor").attr("font-weight","bold").text(r),b.node()}(t,r);default:throw new Error(`unknown legend type: ${n}`)}}function Ef(t){const{r:n,g:r,b:o}=e.rgb(t)||e.rgb(0,0,0);return t=>`rgba(${n},${r},${o},${t})`}var xf="#ch-plugin-legend",Rf={enabled:!0,itemSelector:null,label:null,width:130},Cf=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="Legend",this.calendar=t,this.root=null,this.shown=!1,this.options=Rf}var r,o,i;return r=e,o=[{key:"setup",value:function(t){this.options=Object.assign(Object.assign({},Rf),t)}},{key:"paint",value:function(){var e=this.calendar.options.options.scale,n=this.options,r=n.enabled,o=n.itemSelector;if(!r||o&&t.select(o).empty())return this.destroy();this.shown=!0,this.root=t.select(o||this.calendar.options.options.itemSelector),this.root.select(xf).empty()?this.root=this.root.append("div").attr("id",xf.slice(1)):this.root=this.root.select(xf);var i=function(t={}){for(const[e,n]of Tf){const r=t[e];if(Hs(r)){const o=Sl(t);let i;if("symbol"===e){const{fill:e,stroke:n=(void 0===e&&Hs(t.color)?"color":void 0)}=t;i={fill:e,stroke:n}}return n(lf(e,r,i),$f(o,r,t),(e=>Hs(t[e])?lf(e,t[e]):null))}}throw new Error("unknown legend type; no scale found")}(Object.assign(Object.assign({},e),this.options));return this.root.selectAll("*").remove(),this.root.append((function(){return i})),Promise.resolve()}},{key:"destroy",value:function(){return null!==this.root&&(this.root.remove(),this.root=null),Promise.resolve()}}],o&&n(r.prototype,o),i&&n(r,i),Object.defineProperty(r,"prototype",{writable:!1}),e}();return Cf}));//# sourceMappingURL=Legend.min.js.map
